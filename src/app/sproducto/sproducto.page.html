<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button
        (click)="goBack()"
        defaultHref="home"
        text=""
        color="rgb(165, 17, 233)">
      </ion-back-button>
    </ion-buttons>
    <ion-title>Subir Producto</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="form-wrapper">
    <div class="form-container">
      <h1 style="color: #fff;">Registrar Enser</h1>
      <p>Completa los datos del producto que deseas compartir o donar.</p>

      <!-- Formulario principal -->
      <form (ngSubmit)="onSubmit(productForm)" #productForm="ngForm">

        <!-- üîπ T√çTULO DEL ENSER -->
        <ion-item class="custom-item green-border">
          <ion-label position="floating">T√≠tulo</ion-label>
          <ion-input
            class="custom-input"
            type="text"
            placeholder="Ej. Mesa de comedor"
            [(ngModel)]="enser.titulo"
            name="titulo"
            required>
          </ion-input>
        </ion-item>

        <!-- üîπ DESCRIPCI√ìN -->
        <ion-item class="custom-item green-border">
          <ion-label position="floating">Descripci√≥n</ion-label>
          <ion-textarea
            class="custom-input"
            placeholder="Describe el estado o detalles del producto"
            [(ngModel)]="enser.descripcion"
            name="descripcion"
            rows="4"
            required>
          </ion-textarea>
        </ion-item>

        <!-- üîπ CATEGOR√çA -->
        <ion-item class="custom-item green-border">
          <ion-label position="floating">Categor√≠a</ion-label>
          <ion-select
            placeholder="Selecciona una categor√≠a"
            [(ngModel)]="enser.categoria_id"
            name="categoria_id">
            <ion-select-option value="1">Muebles</ion-select-option>
            <ion-select-option value="2">Electrodom√©sticos</ion-select-option>
            <ion-select-option value="3">Ropa</ion-select-option>
            <ion-select-option value="4">Libros</ion-select-option>
            <ion-select-option value="5">Otros</ion-select-option>
          </ion-select>
        </ion-item>

        <!-- üîπ VALOR EN PUNTOS -->
        <ion-item class="custom-item green-border">
          <ion-label position="floating">Valor en puntos</ion-label>
          <ion-input
            class="custom-input"
            type="number"
            placeholder="Ej. 50"
            [(ngModel)]="enser.valor_puntos"
            name="valor_puntos"
            required>
          </ion-input>
        </ion-item>

        <!-- üîπ CIUDAD -->
        <ion-item class="custom-item green-border">
          <ion-label position="floating">Ciudad</ion-label>
          <ion-input
            class="custom-input"
            type="text"
            placeholder="Ej. Quillota"
            [(ngModel)]="enser.ciudad"
            name="ciudad"
            required>
          </ion-input>
        </ion-item>

        <!-- üîπ REGI√ìN -->
        <ion-item class="custom-item green-border">
          <ion-label position="floating">Regi√≥n</ion-label>
          <ion-input
            class="custom-input"
            type="text"
            placeholder="Ej. Valpara√≠so"
            [(ngModel)]="enser.region"
            name="region"
            required>
          </ion-input>
        </ion-item>

        <!-- üîπ INPUT DE IMAGEN -->
        <!-- Este bloque permite seleccionar la imagen que se subir√° a Supabase Storage -->
        <ion-item class="custom-item green-border">
          <ion-label>Seleccionar imagen</ion-label>
          <input
            type="file"
            (change)="onFileSelected($event)"
            accept="image/*"
            style="color: white; padding: 10px"
          />
        </ion-item>

        <!-- Mostrar nombre de imagen seleccionada -->
        <div *ngIf="selectedFile" style="color: white; font-size: 14px; margin-top: 5px;">
          Imagen seleccionada: {{ selectedFile.name }}
        </div>

        <!-- üîπ BOT√ìN ENVIAR -->
        <div class="centrar">
          <ion-button
            type="submit"
            class="custom-button white-background"
            fill="solid"
            shape="round">
            Guardar Enser
          </ion-button>
        </div>
      </form>
    </div>
  </div>
</ion-content>
